CREATE VIEW payments
AS SELECT id, created_at, completed_at, data
FROM (
    SELECT id, created_at, received_at AS completed_at, data
    FROM payments_incoming
UNION ALL
    SELECT id, created_at, sent_at AS completed_at, data
    FROM payments_outgoing
);

list:
SELECT data
FROM payments
WHERE
    completed_at BETWEEN :completed_at_from AND :completed_at_to
LIMIT :limit OFFSET :offset;


